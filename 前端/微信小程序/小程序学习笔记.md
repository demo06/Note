# 微信小程序学习笔记



### 环境安装

- 接口部分
  - python +django +drf
  - 开发工具
- 小程序环境
  - 申请微信公众平台账号
  - 保存APPID :wxee14228596e0ec3f
  - 下载开发者工具
  - 创建项目
    - 不使用云服务

### 小程序目录结构

```
index 
	|===>index.js		  \\专门写js逻辑的
	|===>index.json        \\配置文件
	|===>index.wxml        \\专门写html页面
	|===>index.wxss        \\专门写CSS样式
app.js             \\全局js逻辑控制
app.wxss		   \\全局CSS样式
app.json    	   \\全局配置

sitemap.json       \\暴漏给微信爬虫,告诉那些页面开放
```

### 组件

- text 编写文本信息,类似span
- view  容器,类似于div标签
- image  图片标签

### 样式

- 像素
  - html使用px
  - wx 使用rpx ,小程序中建议使用此像素单位,整个页面规定宽度750rpx
- overflow  超过父布局部分
  - ​	hidden

### flex布局

>  由X,Y轴的朝向控制方向display:flex,是所有前端都通用的属性

- flex-direction  规定X轴方向
  -   row X轴水平方向排列 
  -   column X轴垂直方向排列 
  -   column-reverse 垂直方向排列从下网上
  -   row-reverse规定X轴从右往左
- justify-content   在X 轴方向确定后如何排列
  -   center居中排列  
  -   space-around平均分  
  -   space-between两边对齐   
  -   flex-start 左对齐
  - ...剩下的查百科
- align-items   在Y轴垂直时方向如何展示
  -   flex-end  Y轴右对齐
  -   flex-start Y轴左对齐
  -   center Y轴居中对齐

### 跳转

- 绑定点击事件

- bindtap函数绑定js事件

- 在js中定义该事件函数

- 传参数则需要使用data-函数 -后面指定参数名

  ```
  // wxml
   <text class="homepage" bindtap="onclick" data-name="rick">
  
   //js
   // 点击绑定的事件
   onclick:function(e){
      var name=e.currentTarget.dataset.name
      console.log(name)
      //跳转注意跳转的页面不能是tab页,不然跳转无效
      //跳转tab页则需要使用wx.switchTab
      wx.navigateTo({
        url: '/pages/rick/rick?name='+name,
      })
    }
   
  ```

  跳转到的页面如果要接收参数,在跳转页的js中的onload方法中接收

  #### 通过标签跳转

  ```
  <navigator url="/pages/rick/rick?id=666">rick传送到其他宇宙</navigator>
  ```

  ### 数据绑定

  - 与MVVM大致相同
  - 标签中使用 {{message}}
  
  ```
  //wxml
  <view class="rick" bindtap="onclick">跳转{{msg}}</view>
  
  //js
  onclick:function(){
      this.setData({
        msg:"rick"
      })
    }
  ```
  
  获取用户信息
  
  ```
  wx.getUserInfo()//已废弃
  //使用
  wx.getUserProfile()
  ```



### 基本显示

> 默认值一般设置在 js 头部data标签内

```
data: {
    name:"rick",
    headurl:"/static/rick.jpg"
  },
```

在标签上使用时

```
<view>当前用户名{{name}}</view>
<view>当前头像
<image class="headurl" src="{{headurl}}"></image>
```

### 修改数据

```
<view class="head-name" bindtap="onclick" data-name="rick">
```

通过js控制

```
 // 点击绑定的事件
  onclick: function () {
    this.setData({
      msg: "rick"
    })
  },
```

### 获取用户数据

#### 方式一

- wxml

```
<button bindtap="getuser">获取用户名</button>
```

- js

```
  getuser: function () {
    wx.getUserProfile({
      desc: '用于完善会员资料', // 声明获取用户个人信息后的用途，后续会展示在弹窗中，请谨慎填写
      success: (res) => {
        console.log(res)
        this.setData({
          name: res.userInfo.nickName,
          headurl:res.userInfo.avatarUrl,
          hasUserInfo: true
        })
      }
    })
  }

```

#### 方式二

> 此种方式已废弃,使用此种方法将会获取到返回的虚拟信息,建议使用方式一

- wxml

```
<button open-type="getUserInfo" bindgetuserinfo="getuser2">登录rick</button>
```

- js

```
getuser2: function () {
    wx.getUserInfo({
      success: (res) => {
        console.log(res)
        this.setData({
          name: res.userInfo.nickName,
          headurl: res.userInfo.avatarUrl,
        })
      }
    })
  }
```

注意事项:

- 想要获取用户信息,必须经过用户授权
- 不授权的话需要通过调用 wx.opensetting

```
//打开配置,手动授权
wx.opensetting({})
```

### 获取用户的位置信息

- wxml

```
<view bindtap="getLocation">当前位置信息{{location}}</view>
```

- js

```
getLocation() {
    wx.chooseAddress({
      success: (result) => {
        this.setData({
          location: result.cityName
        })
      },
    })
  }
```





看到重新看

[两周学会Python+微信小程序开发实战（免费分享完整版）_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1E54y1L7op?p=16&spm_id_from=pageDriver)
